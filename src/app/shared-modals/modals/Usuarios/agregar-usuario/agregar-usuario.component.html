<h2 mat-dialog-title>
  {{ data.modo === 'agregar' ? 'Agregar Usuario' : (data.modo === 'editar' ? 'Editar Usuario' : 'Eliminar Usuario') }}
</h2>

<mat-dialog-content *ngIf="data.modo !== 'eliminar'">
  <form [formGroup]="usuarioForm" class="usuario-form">

    <mat-form-field appearance="fill" class="full-width">
      <mat-label>Nombre</mat-label>
      <input matInput formControlName="nombre" />
      <mat-error *ngIf="usuarioForm.get('nombre')?.hasError('required')">El nombre es requerido</mat-error>
      <mat-error *ngIf="usuarioForm.get('nombre')?.hasError('pattern')">Solo letras permitidas</mat-error>
    </mat-form-field>

    <mat-form-field appearance="fill" class="full-width">
      <mat-label>Apellido Paterno</mat-label>
      <input matInput formControlName="apellidoPaterno" />
      <mat-error *ngIf="usuarioForm.get('apellidoPaterno')?.hasError('required')">El apellido paterno es requerido</mat-error>
    </mat-form-field>

    <mat-form-field appearance="fill" class="full-width">
      <mat-label>Apellido Materno</mat-label>
      <input matInput formControlName="apellidoMaterno" />
      <mat-error *ngIf="usuarioForm.get('apellidoMaterno')?.hasError('required')">El apellido materno es requerido</mat-error>
    </mat-form-field>

    <mat-form-field class="full-width">
      <mat-label>Cargo</mat-label>
      <mat-select formControlName="id_rol">
        <mat-option *ngFor="let r of data.roles" [value]="r.id">{{ r.rol }}</mat-option>
      </mat-select>
      <mat-error *ngIf="usuarioForm.get('id_rol')?.hasError('required')">El rol es requerido</mat-error>
    </mat-form-field>

    <mat-form-field appearance="fill" class="full-width">
      <mat-label>Teléfono</mat-label>
      <input matInput formControlName="telefono" maxlength="10" />
      <mat-error *ngIf="usuarioForm.get('telefono')?.hasError('required')">El teléfono es requerido</mat-error>
      <mat-error *ngIf="usuarioForm.get('telefono')?.hasError('pattern')">Solo números válidos</mat-error>
    </mat-form-field>

    <mat-form-field appearance="fill" class="full-width">
      <mat-label>Correo electrónico</mat-label>
      <input matInput formControlName="correo" />
      <mat-error *ngIf="usuarioForm.get('correo')?.hasError('required')">El correo es requerido</mat-error>
      <mat-error *ngIf="usuarioForm.get('correo')?.hasError('email')">Correo inválido</mat-error>
    </mat-form-field>

    <mat-form-field appearance="fill" class="full-width">
      <mat-label>Contraseña</mat-label>
      <input matInput type="password" formControlName="password" />
      <mat-error *ngIf="usuarioForm.get('password')?.hasError('required')">La contraseña es requerida</mat-error>
      <mat-error *ngIf="usuarioForm.get('password')?.hasError('minlength')">Mínimo 6 caracteres</mat-error>
    </mat-form-field>
 
  </form>
</mat-dialog-content>

<!-- Modo eliminar -->
<mat-dialog-content *ngIf="data.modo === 'eliminar'">
  <p>¿Seguro que quieres eliminar al usuario <strong>{{ data.usuario.nombre }} {{ data.usuario.apellidoPaterno }}</strong>?</p>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button (click)="cancelar()">Cancelar</button>
  <button mat-flat-button color="primary" *ngIf="data.modo !== 'eliminar'" [disabled]="usuarioForm.invalid" (click)="guardar()">Guardar</button>
  <button mat-flat-button color="warn" *ngIf="data.modo === 'eliminar'" (click)="eliminar()">Eliminar</button>
</mat-dialog-actions>
